# Progress Log — 2026-01-24
Project: **webhost.systems** (v1)  
Focus: **Dashboard polish** — add *Documentation* + *Account* pages; start improving *Agents* navigation toward a sortable/searchable table  
Owner: Engineering

## Summary (what changed today)
- Started **Slice B dashboard navigation polish** by adding dedicated pages for:
  - **Account** (identity + tier/usage snapshot; billing placeholder)
  - **Documentation** (spec-first quick links + local quickstart notes)
- Began refactoring the dashboard shell so **Account** and **Documentation** are no longer “coming soon” placeholders.
- Improved Agents navigation by replacing the left “agent buttons” list with a **sortable/searchable/filterable** agents table.
- Implemented Agents routing as **two separate pages** using **query-string routes** (so `#...` remains available for in-page section anchors):
  - Agents list: `?page=agents`
  - Agent detail: `?page=agent&agentId=<agentId>`

---

## What shipped today

### Dashboard/UI
#### 1) Account page (new)
- Added a new **Account** page intended to become the home for:
  - identity info (from Clerk),
  - tier + usage snapshot (from control plane),
  - billing/subscription UI (placeholder for now).

Notes:
- The page pulls usage using the existing `GET /v1/usage/current` endpoint via `ControlPlaneClient`.
- The page intentionally does **not** introduce any new server endpoints yet.

#### 2) Documentation page (new)
- Added a new **Documentation** page intended to be a “spec-first index”:
  - links to `project_spec/spec_v1` and ADRs (via GitHub),
  - quick local env reminders,
  - quick list of endpoints exercised by the dashboard.

Notes:
- This stays non-normative and points back to the spec set as the source of truth.

#### 3) Sidebar navigation updated
- Updated the authed sidebar nav so:
  - “Documentation” is a first-class route label (instead of “Docs”).
  - “Account” route renders the new Account page.
  - “Documentation” route renders the new Documentation page.

---

## Agents UI — shipped (agents table)
### What shipped
Replaced the left “agent buttons” list with a **table-driven Agents sidebar** that supports:
- **Search**: client-side substring match across name/description/id/status/runtime + active deployment id.
- **Filters**:
  - status (`draft|ready|deploying|active|error|disabled|deleted`)
  - runtime (`cloudflare|agentcore|unknown`)
  - deployment state (has active deployment / none)
- **Sorting** (client-side):
  - `name`, `status`, `preferredRuntimeProvider`, `hasActiveDeployment`, `updatedAtMs`, `createdAtMs`, `_id`
  - sensible defaults (e.g. `updatedAtMs` desc, `hasActiveDeployment` desc)
- **Selection**: clicking a row selects the agent (preserving the existing “left list + right detail panels” layout).

### Notes / follow-ups
- This is intentionally dependency-free (no table library).
- Next UX polish: when the selected agent is filtered out, show a small banner (or adjust the selection policy) so the state doesn’t feel “lost”.
- Routing follow-up (requested): move to **two separate pages**:
  - `Agents` list route (table + create)
  - `Agent` detail route (deploy/invoke/deployments/telemetry for a selected agent)

---

## Spec/ADR alignment notes
- ✅ Dashboard improvements are **non-normative** and remain aligned with:
  - `10_API_CONTRACTS.md` (usage endpoint for tier/usage display)
  - `00_MASTER_SPEC.md` (dashboard requirements / views)
- ✅ No changes to the control-plane boundary or security model.
- ⚠️ Billing UI is still placeholder; webhook-driven tier updates remain a future phase.

---

## Files touched (high-level)
- `apps/web/src/App.tsx` — route wiring + nav label updates
- `apps/web/src/components/AccountPage.tsx` — new (now rendered)
- `apps/web/src/components/DocsPage.tsx` — new (now rendered)
- `apps/web/src/components/AgentsPage.tsx` — replaced agent sidebar list with sortable/searchable/filterable table
- `apps/web/src/index.css` — added table/control styles to support the Agents table UX

---

## Validation performed
- Manual UI sanity:
  - navigation switches between Dashboard / Agents / Account / Documentation
  - Agents sidebar table: search/filter/sort works and selection updates the right-side detail view
  - Account page loads usage (when control plane env is configured)
- Typecheck:
  - `npm run typecheck -w apps/web`
- No new server endpoints added.

---

## Known issues / risks
- Agents table UX is a first pass:
  - selection can become “hidden” if filters/search exclude the selected agent (needs a banner or consistent selection policy)
- Agents list/detail split is now implemented using query-string routing:
  - list: `?page=agents` renders only the table/create UI
  - detail: `?page=agent&agentId=<agentId>` renders only deploy/invoke/deployments/telemetry for that agent
- Hash (`#...`) is reserved for in-page anchors (section jumps) within each page.
- Avoid duplicating token-fetch logic across pages long-term:
  - consider extracting a shared `useControlPlaneClient()` hook now that multiple pages use the same pattern.

---

## Next steps
- [ ] Agents routing polish (query-string routes):
  - [ ] verify deep links:
    - `?page=agents`
    - `?page=agent&agentId=<agentId>`
  - [ ] verify list → detail navigation and detail → list back work with browser history
  - [ ] confirm in-page anchors still work on Account/Docs/Agents pages (hash is not used for routing)
- [ ] Agents table polish:
  - [ ] show a banner when filters/search exclude the selected agent (if/when a combined view exists again), or ensure the detail route drives selection cleanly
  - [ ] move remaining inline table styles toward the CSS classes for consistency
- [ ] Add a small “agent quick actions” row for the selected agent (copy id, refresh, open deployments section).
- [ ] Extract a shared `useControlPlaneClient()` hook to eliminate repetition across Dashboard/Agents/Account.
- [ ] Start wiring real billing once checkout + webhook flows are implemented (per spec).
